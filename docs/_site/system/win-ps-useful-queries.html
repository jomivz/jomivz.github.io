<h2 id="ps-sysadmin-useful-queries">PS sysadmin useful queries</h2>

<ul>
  <li>Installing telnet clients   :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Import-module servermanager
Add-windowsfeature telnet-client
</code></pre></div>    </div>
  </li>
  <li>ActiveDirectory module mandatory for the following commands :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Import-module ActiveDirectory
</code></pre></div>    </div>
  </li>
  <li>Listing User Groups   :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ADuser x123456 -Property * | Select-Object -ExpandProperty MemberOf 
</code></pre></div>    </div>
  </li>
  <li>Listing Group Members :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ADGroup EMEA-PXY-Web-ReadWrite -Property * | Select-Object -ExpandProperty Member 
</code></pre></div>    </div>
  </li>
  <li>PasswordLastSet       :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ADUser 'x123456' -properties PasswordLastSet | Format-List
</code></pre></div>    </div>
  </li>
  <li>Matching Group Name for USB :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ADuser x123456 -Property * | Select-Object -ExpandProperty MemberOf | findstr 'DEVICECONTROL'
</code></pre></div>    </div>
  </li>
  <li>Matching Group Name for DA :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ADuser x123456 -Property * | Select-Object -ExpandProperty MemberOf | findstr 'Domain Admins'
</code></pre></div>    </div>
  </li>
  <li>Matching Group Name 2 :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ADPrincipalGroupMembership -Identity x123456 | Select-Object -ExpandProperty MemberOf  | Where-Object {$_.name -like '*DEVICECONTROL*' } 		
</code></pre></div>    </div>
  </li>
  <li>Listing Computer Info :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ADComputer -Filter {Name -Like "dell-xps*"} -Property * | Format-Table Name,OperatingSystem,OperatingSystemServicePack,OperatingSystemVersion -Wrap -Auto
</code></pre></div>    </div>
  </li>
  <li>Listing Win &gt; 6.1 	:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-ADComputer -Filter {OperatingSystemVersion -ge "6.1"} -Property * | Format-Table Name,OperatingSystem,OperatingSystemVersion -Wrap -Auto
</code></pre></div>    </div>
  </li>
</ul>
