<h1 id="nmap-cheatsheet">NMAP cheatsheet</h1>

<h2 id="keypoints-scanning-udp-connections">Keypoints scanning UDP connections</h2>

<ul>
  <li>When the target’s UDP port is open, (except for well-known port) there is no response from the target. NMAP refers the port as being <code class="language-plaintext highlighter-rouge">open|filtered</code>.</li>
  <li>When the target’s UDP port is closed, the response expected is an ICMP port unreachable. NMAP refers the port as being <code class="language-plaintext highlighter-rouge">closed</code>.</li>
  <li>For well-known UDP port, NMAP will forge payload (instead of empty). In case of response, NMAP refers the port as being <code class="language-plaintext highlighter-rouge">opened</code>.</li>
  <li>Due the slowness of scanning UDP connections, run Nmap with the <code class="language-plaintext highlighter-rouge">--top-ports &lt;number&gt;</code> option.</li>
</ul>

<h2 id="keypoints-scanning-tcp-connections">Keypoints scanning TCP connections</h2>

<ul>
  <li>Compare to TCP connect scans, <code class="language-plaintext highlighter-rouge">SYN</code> / <code class="language-plaintext highlighter-rouge">NULL</code> / <code class="language-plaintext highlighter-rouge">Xmas</code> scans have the following common points:
    <ul>
      <li>it is often not logged by applications listening on open ports.</li>
      <li>it requires the ability to create raw packets (as opposed to the full TCP handshake), which is a root privilege by default.</li>
      <li>When the target’s TCP port is open, there is usually no response. Firewall may also respond with no response or with an ICMP port unreachable when <code class="language-plaintext highlighter-rouge">filtered</code>.</li>
      <li>When the target’s TCP port is closed, the response expected is an TCP RST if the port is closed.</li>
      <li>Either TCP port are <code class="language-plaintext highlighter-rouge">opened</code> or <code class="language-plaintext highlighter-rouge">closed</code>, Windows OS respond with a TCP RST.</li>
    </ul>
  </li>
</ul>

<p>You may refer to the <a href="https://tools.ietf.org/html/rfc793">RFC 793</a> to get more information about the TCP protocol.</p>

<h2 id="nse-scripts">NSE scripts</h2>

<p>NMAP uses the following options for NSE scripts :</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">--script=&lt;category&gt;</code> where category is one of the following values: <code class="language-plaintext highlighter-rouge">safe</code>, <code class="language-plaintext highlighter-rouge">intrusive</code>, <code class="language-plaintext highlighter-rouge">vuln</code>, <code class="language-plaintext highlighter-rouge">exploit</code>, <code class="language-plaintext highlighter-rouge">brute</code>, <code class="language-plaintext highlighter-rouge">auth</code>, <code class="language-plaintext highlighter-rouge">discoevry</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">--script=&lt;name&gt; --script-args=&lt;arg1&gt;, &lt;arg2&gt;</code> where you may refer to the <code class="language-plaintext highlighter-rouge">/usr/share/nmap/scripts/</code> directory or <a href="https://nmap.org/nsedoc/">nmap.org</a> to get the full list.</li>
  <li><code class="language-plaintext highlighter-rouge">--script-help=&lt;name&gt;</code> for help on the script.</li>
</ul>

<h2 id="nmap-default-behavior">NMAP Default behavior</h2>

<ul>
  <li>By default, Windows firewall blocks all ICMP packets and NMAP does not scan hosts not answering to <code class="language-plaintext highlighter-rouge">ping</code>.</li>
  <li>Thus use the option <code class="language-plaintext highlighter-rouge">-Pn</code> as workaround</li>
</ul>

<h2 id="firewall-evasion">Firewall evasion</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">-f</code> : use fragments</li>
  <li><code class="language-plaintext highlighter-rouge">-mtu</code> : use lower MTU to split packets than 1500 (standard value for ethernet LAN)</li>
  <li><code class="language-plaintext highlighter-rouge">--scan-delay &lt;:digit:&gt;ms</code> : avoiding time-based alerts.</li>
  <li><code class="language-plaintext highlighter-rouge">--badsum</code>: behavior to test</li>
  <li><code class="language-plaintext highlighter-rouge">-S &lt;IP_Address&gt;</code>: Spoof the source address</li>
</ul>

<p>You may refer to the <a href="https://nmap.org/book/man-bypass-firewalls-ids.html">nmap.org firewall evasion</a> page for futher information.</p>
